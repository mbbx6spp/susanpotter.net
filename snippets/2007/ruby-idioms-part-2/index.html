<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Language" content="en">

    <meta name="author" content="Susan Potter">
    <meta name="description" content="Now the &#34;idiom&#34; we will use is not specific to Ruby, since I am pretty sure Perl has one of the constructs we will use to solve the stated problem, but it is still idiomatic, since the majority of popular OO languages (static, dynamic or otherwise) do not have it (as far as I know). Also some consider this to be a sub-optimal idiom, because there is a terser way to do something like this.">
    <meta name="keywords" content="Distributed Systems, Functional Programming, Systems Architecture, Software Development, Software Engineering Leadership, Technical Strategy">

    

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Ruby Idioms, Part 2"/>
<meta name="twitter:description" content="Now the &#34;idiom&#34; we will use is not specific to Ruby, since I am pretty sure Perl has one of the constructs we will use to solve the stated problem, but it is still idiomatic, since the majority of popular OO languages (static, dynamic or otherwise) do not have it (as far as I know). Also some consider this to be a sub-optimal idiom, because there is a terser way to do something like this."/>

    <meta property="og:title" content="Ruby Idioms, Part 2" />
<meta property="og:description" content="Now the &#34;idiom&#34; we will use is not specific to Ruby, since I am pretty sure Perl has one of the constructs we will use to solve the stated problem, but it is still idiomatic, since the majority of popular OO languages (static, dynamic or otherwise) do not have it (as far as I know). Also some consider this to be a sub-optimal idiom, because there is a terser way to do something like this." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/snippets/2007/ruby-idioms-part-2/" />
<meta property="article:published_time" content="2007-01-22T19:21:00-06:00" />
<meta property="article:modified_time" content="2007-01-22T19:21:00-06:00" />


    
      <base href="/snippets/2007/ruby-idioms-part-2/">
    
    <title>
  Ruby Idioms, Part 2 · Susan Potter
</title>

    
      <link rel="canonical" href="/snippets/2007/ruby-idioms-part-2/">
    

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.13.0/css/all.css" integrity="sha384-Bfad6CLCknfcloXFOyFnlgtENryhrpZCe29RTifKEixXQZ38WheV+i/6YWSzkz3V" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />

    
      
      
      <link rel="stylesheet" href="/css/coder.min.3219ef62ae52679b7a9c19043171c3cd9f523628c2a65f3ef247ee18836bc90b.css" integrity="sha256-MhnvYq5SZ5t6nBkEMXHDzZ9SNijCpl8&#43;8kfuGINryQs=" crossorigin="anonymous" media="screen" />
    

    

    

    
      <link rel="stylesheet" href="/styles/main.css" />
    

    

    <link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

    <meta name="generator" content="Hugo 0.64.0" />
  </head>

  
  
  <body class="colorscheme-light"
        onload=""
  >
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="/">
      Susan Potter
    </a>
    
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="/about/">About</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="/talks/">Talks</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="/software/">Software</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="/snippets/">Snippets</a>
          </li>
        
      
      
    </ul>
    
  </section>
</nav>


      <div class="content">
        
  <section class="container page">
  <article>
    <header>
      <h1>Ruby Idioms, Part 2</h1>
    </header>

    <p>
Now the &#34;idiom&#34; we will use is not specific to Ruby, since I am pretty
sure Perl has one of the  constructs we will use to solve the stated
problem, but it is still idiomatic, since the majority of popular OO
languages (static, dynamic or otherwise) do not have it (as far as I
know).  Also some consider this to be a sub-optimal idiom, because
there is a terser way to do something like this.  However, the idiom I
recommend below is much more multi-purpose, though I will show the
terser version for the trivial case.
</p>
<p>
Firstly our Javafied Ruby code looks like the following for the
problem at hand:
</p>
<div class="src src-ruby">
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby">    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> var
      var <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">some text string</span><span style="color:#e6db74">&#34;</span>
    <span style="color:#66d9ef">end</span>
    <span style="color:#75715e"># OR for a pure Java to Ruby translation with ZERO Rubification</span>
    <span style="color:#66d9ef">if</span> <span style="color:#66d9ef">nil</span> <span style="color:#f92672">==</span> var <span style="color:#75715e"># of course &#34;if var == nil&#34; is equivalent too.</span>
      var <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">some text string</span><span style="color:#e6db74">&#34;</span>
    <span style="color:#66d9ef">end</span></code></pre></div>
</div>
<p>
Now this is the most trivial case of wanting to set a variable to a
value only when it is <code class="verbatim">nil</code>. The Ruby idiom I advocate is much more
versatile than for this trivial case, but there is an even terser Ruby
idiom that is only applicable to this case, which I wanted to show you
first:
</p>
<div class="src src-ruby">
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby">    var <span style="color:#f92672">||</span><span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">some text string</span><span style="color:#e6db74">&#34;</span></code></pre></div>
</div>
<p>
As you can see this is very terse, but my question is, is it readable?
Well to many Rubyists it is, but this relies on expressionistic
understanding of how Ruby works under the covers.  On projects
involving developers with varied skill levels, I would definitely
prefer my proposal below.
</p>
<p>
Now onto the more readable and more multi-purpose idiom that reads
much more like my natural language (which is my preference in
general):
</p>
<div class="src src-ruby">
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby">    var <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">some text string</span><span style="color:#e6db74">&#34;</span> <span style="color:#66d9ef">unless</span> var</code></pre></div>
</div>
<p>
Now some of you may think this isn&#39;t as readable as it could be, I
concur.  I sometimes prefer to use something like the following, but
consistency on a project is important in my view, so pick on and go
with it:
</p>
<div class="src src-ruby">
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby">    var <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">some text string</span><span style="color:#e6db74">&#34;</span> <span style="color:#66d9ef">if</span> var<span style="color:#f92672">.</span>nil?</code></pre></div>
</div>
<p>
I do find myself using the terser &#34;or equals&#34; idiom in favor of the
above for the trivial case (but consistently on projects with other
advanced Ruby developers).  The &#34;if var nil?&#34; idiom can be used in
more multi-purpose situations, not only when you wish to set a
variable when it has a <code class="verbatim">nil</code> value (that is null to you Java heads).
</p>
<p>
A non-trivial usage of the &#34;unless&#34; version of the idiom would be well
suited to a code snippet that tries to do the following:
</p>
<div class="src src-ruby">
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby">    user_defined_fruits <span style="color:#f92672">=</span> <span style="color:#f92672">[</span><span style="color:#e6db74">&#39;apple&#39;</span>, <span style="color:#e6db74">&#39;cantaloupe&#39;</span><span style="color:#f92672">]</span>
    fruits <span style="color:#f92672">=</span> <span style="color:#f92672">[</span><span style="color:#e6db74">&#39;apple&#39;</span>, <span style="color:#e6db74">&#39;banana&#39;</span><span style="color:#f92672">]</span>
    user_defined_fruits<span style="color:#f92672">.</span>each <span style="color:#66d9ef">do</span> <span style="color:#f92672">|</span>fruit<span style="color:#f92672">|</span>
      <span style="color:#66d9ef">if</span> fruits<span style="color:#f92672">.</span>include? fruit
        fruits <span style="color:#f92672">&lt;&lt;</span> fruit
      <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">end</span>
    fruits <span style="color:#75715e">#=&gt; [&#39;apple&#39;, &#39;banana&#39;, &#39;cantaloupe&#39;] NOT [&#39;apple&#39;, &#39;banana&#39;, &#39;apple&#39;, &#39;cantaloupe&#39;]</span></code></pre></div>
</div>
<p>
Now a better way of doing this with the &#34;unless&#34; version of the idiom
would be:
</p>
<div class="src src-ruby">
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby">    user_defined_fruits <span style="color:#f92672">=</span> <span style="color:#f92672">[</span><span style="color:#e6db74">&#39;apple&#39;</span>, <span style="color:#e6db74">&#39;cantaloupe&#39;</span><span style="color:#f92672">]</span>
    fruits <span style="color:#f92672">=</span> <span style="color:#f92672">[</span><span style="color:#e6db74">&#39;apple&#39;</span>, <span style="color:#e6db74">&#39;banana&#39;</span><span style="color:#f92672">]</span>
    user_defined_fruits<span style="color:#f92672">.</span>each <span style="color:#66d9ef">do</span> <span style="color:#f92672">|</span>fruit<span style="color:#f92672">|</span>
      fruits <span style="color:#f92672">&lt;&lt;</span> fruit <span style="color:#66d9ef">unless</span> fruits<span style="color:#f92672">.</span>include? fruit
    <span style="color:#66d9ef">end</span></code></pre></div>
</div>
<p>
As you see above the code is terser, while being as readable, if not
more (in my opinion again).
</p>
<p>
Again the as-terse-as-possible enthusiasts will love the following:
</p>
<div class="src src-ruby">
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby">    user_defined_fruits <span style="color:#f92672">=</span> <span style="color:#f92672">[</span><span style="color:#e6db74">&#39;apple&#39;</span>, <span style="color:#e6db74">&#39;cantaloupe&#39;</span><span style="color:#f92672">]</span>
    fruits <span style="color:#f92672">=</span> <span style="color:#f92672">[</span><span style="color:#e6db74">&#39;apple&#39;</span>, <span style="color:#e6db74">&#39;banana&#39;</span><span style="color:#f92672">]</span>
    fruits <span style="color:#f92672">|=</span> user_defined_fruits</code></pre></div>
</div>

  </article>
</section>

  

      </div>

      
  <footer class="footer">
    <section class="container">
      
      
        ©
        
          2006 -
        
        2020
         Susan Potter 
      
      
         · 
        Powered by <a href="https://gohugo.io/">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/">Coder</a>.
      
      
    </section>
  </footer>

    </main>

    

    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-837842-1', 'auto');
	
	ga('send', 'pageview');
}
</script>


    

  </body>

</html>
